---
lab:
  title: Изучение автоматизированного машинного обучения
---

# Изучение автоматизированного машинного обучения

В этом упражнении вы будете использовать автоматизированное машинное обучение для обучения и оценки модели машинного обучения. Затем вы развернете и протестируете обученную модель.

> **Примечание.** Это упражнение предназначено для обучения и тестирования модели с помощью ***Машинное обучение Azure***. Если у вас есть подписка Azure с достаточными разрешениями, вы можете подготовить рабочую область Машинное обучение Azure и использовать ее для упражнения. Однако Машинное обучение Azure предназначены для решений машинного обучения корпоративного масштаба, которые включают огромные объемы данных и облачных вычислений. Для некоторых операций в Машинное обучение Azure требуются вычисления подготовки, которые могут занять значительное время. Если у вас нет доступа к Azure или у вас есть ограниченное время для выполнения упражнения, приложение лаборатории*** машинного обучения на основе ***браузера, включающее основные функциональные возможности Машинного обучения Azure, используемого в этом упражнении, также предоставляется, и вы можете использовать это для обучения и тестирования реальных моделей машинного обучения, как и в Azure ML. Хотя пользовательский интерфейс в лаборатории машинного обучения не *идентичен* Машинное обучение Azure, это достаточно, чтобы сделать переход на Машинное обучение Azure интуитивно понятным. Обратите внимание, что приложение лаборатории машинного обучения выполняется в браузере, поэтому обновление страницы в любой момент перезагрузит приложение!

Это упражнение должно занять около **35** минут (меньше, если вы используете приложение лаборатории машинного обучения на основе браузера).

## Создание рабочей области

Рабочая область используется для объединения всех ресурсов машинного обучения, что упрощает управление данными, кодом, моделями и другими ресурсами в одном месте.

1. Откройте портал для среды, которую вы хотите использовать в этой лаборатории, и войдите, если появится запрос:
    - На основе [Azure Машинное обучение Azure Studio](https://ml.azure.com){:target="_blank"}`https://ml.azure.com`
    - Лаборатория машинного обучения[ на основе ](https://aka.ms/ml-lab)браузера{:target="_blank"}`https://aka.ms/ml-lab`

    > **Совет.** Если Студия машинного обучения Azure откроется в существующей рабочей области, перейдите на **страницу "Все рабочие области**".

1. Создайте рабочую область с подходящим именем.

    Если вы используете Машинное обучение Azure, для этого упражнения не требуется *центр*. Выберите соответствующие расширенные параметры на основе любых ограничений политики в подписке Azure.

1. После создания рабочей области выберите ее для просмотра домашней **** страницы.

    Обратите внимание, что рабочая область содержит несколько страниц, которые отображаются в области навигации слева. Вы можете развернуть и свернуть эту панель с помощью **меню &#9776;** вверху.

## Загрузка данных

В этом упражнении вы будете использовать набор данных о продажах мороженого для обучения модели, которая прогнозирует спрос на мороженое в течение определенного дня на основе сезонных и метеорологических признаков.

1. На новой вкладке браузера скачайте **[ml-data.zip](https://aka.ms/mslearn-ml-data)** с `https://aka.ms/mslearn-ml-data` локального компьютера.
1. Извлеките скачанный **ml-data.zip** архив, чтобы просмотреть содержащиеся в нем файлы. Обратите внимание, что один из этих файлов ice-cream.csv****, который содержит данные о продажах мороженого, необходимые для этого упражнения.

## Используйте автоматизированное машинное обучение для обучения модели

Автоматизированное машинное обучение позволяет попробовать несколько алгоритмов и параметров для обучения нескольких моделей и определить наиболее подходящий для ваших данных.

1. На портале просмотрите страницу **автоматизированного машинного обучения** (в разделе **"Разработка**").

1. Создайте новое задание автоматизированного машинного обучения со следующими параметрами, используя кнопку **Далее** по мере необходимости для продвижения по пользовательскому интерфейсу:

    > **Совет.** Если явные сведения для параметра не указаны в приведенных ниже шагах, используйте значение по умолчанию.

    **Основные параметры**:

    - Назначение уникального **имени** задания для задания автоматизированного машинного обучения

   **Тип задания и данные**:

    - Задайте для типа **задачи регрессию**.
    - Создание нового ***табличного*** ресурса данных с именем **мороженого**
        - Отправьте локальный **ice-cream.csv-файл** в хранилище рабочей области по умолчанию.
        - Включите <u>только</u> следующие столбцы (*Дата* уникальна для каждой строки и добавляет небольшую прогнозную возможность самостоятельно):
            - **DayOfWeek**
            - **Month**
            - **Температура**
            - **Количество осадков**
            - **IceCreamsSold**
        - Создайте ресурс данных.
    - Убедитесь, что созданный ресурс **данных мороженого** выбран перед переходом на следующий шаг

    > **Примечание.** Если вы используете подписку Azure, для которой вы не являетесь администратором, доступ на основе ключей к хранилищу может быть запрещен политикой. В этом случае необходимо работать с администратором, чтобы разрешить доступ на основе ключей или перенастроить рабочую область Машинное обучение Azure, чтобы использовать проверку подлинности идентификатора записи для доступа к хранилищу. Если этого не удается сделать, используйте приложение лаборатории*** машинного обучения на основе ***браузера для этого упражнения.

    **Настройки задания**:

    - Задайте целевой **столбец (метка** , которую мы хотим, чтобы модель прогнозирует) значение **IceCreamsSold**.
    - Задайте **дополнительные параметры конфигурации**:
        - **Задайте для первичной метрики метрику**, которую вы хотите использовать для оценки производительности модели. В этом упражнении *используйте оценку R<sup>2</sup>* .
        - Выберите алгоритмы модели, которые вы хотите попробовать (или оставить все выбранные)
    - Задайте **параметры** признаков:
        - Используйте эти параметры для настройки признаков (как функции данных подготовлены для обучения модели)
    - Задайте **ограничения**:
        - Используйте ограничения, чтобы завершить задание обучения рано на основе определенных критериев. В этом упражнении задайте следующие ограничения:
            - **Пороговое значение** оценки метрик: 0,9
            - **Время ожидания эксперимента (минуты)**: 15
        
        > **Обратите внимание**, что важно задать эти ограничения при использовании Машинное обучение Azure, так как выполнение заданий обучения для каждого возможного алгоритма и сочетания признаков может занять несколько часов!

    **Вычисления.**

    - Использование **бессерверных** вычислений

    **Отзыв**

    - Просмотрите параметры и внимательно проверьте их. Затем отправьте задание обучения. Запускается автоматически.

1. Дождитесь остановки задания.

    > **Совет**. Если вы используете Машинное обучение Azure, это может занять некоторое время — теперь может быть хорошим временем для кофе-перерыва!

## Проверка наилучшей модели

После завершения задачи автоматизированного машинного обучения вы можете просмотреть лучшую модель, которую она обучила.

1. **На вкладке "Обзор**" страницы сведений о задании просмотрите сведения о задании и запишите лучшую сводку модели.
  
1. Выберите **Имя алгоритма** лучшей модели для просмотра сведений. Затем на странице сведений о дочернем задании просмотрите следующие вкладки:
    - **Обзор**. Общие сведения о дочернем задании.
    - **Модель**: сведения об обученной модели.
    - **Метрики** оценки и визуализации для модели на основе тестовых данных, используемых во время обучения.
    - **Выходные данные и журналы**: информация, зарегистрированная во время обучения.

## Развертывание и тестирование модели

1. На вкладке **"Модель"** для оптимальной модели, обученной заданием автоматизированного машинного обучения, выберите **"Развернуть** ", чтобы развернуть модель в конечной точке реального времени.

    Выберите соответствующие **экземпляры** и **параметры виртуальной машины** для вычислений, на которых будет выполняться развернутая конечная точка (которая может зависеть от квоты, доступной в подписке Azure), и назначьте подходящие **имена конечных точек** и **развертываний** .

1. Подождите уведомления о завершении развертывания.

    > **Совет.** В Студия машинного обучения Azure развертывание конечной точки может занять 5–10 минут.

## Тестирование развернутой службы

Теперь можно протестировать развернутую службу.

1. В меню навигации выберите **страницу "Конечные точки"** и откройте созданную конечную точку в режиме реального времени.

1. На странице конечной точки перейдите на вкладку **"Тест".**

1. В области **Входные данные для тестирования конечной точки** замените шаблон JSON указанными ниже входными данными:

    ```json
   {
     "input_data": {
        "columns": [
            "DayOfWeek",
            "Month",
            "Temperature",
            "Rainfall"
        ],
        "index": [0],
        "data": [["Wednesday","June",70.5,0.05]]
     }
   }
    ```

1. Нажмите кнопку **Проверить**.

1. Проверьте результаты теста, которые включают прогнозируемое количество прокатов на основе входных функций — примерно так:

    ```JSON
   [
       120.16208168753236
   ]
    ```

    На панели тестирования были введены входные данные и использована модель, обученная для возврата прогнозируемого числа прокатов.

## Просмотр кода для использования модели

Теперь, когда у вас есть прогнозная модель, разработчики могут создавать приложения, использующие его.

1. На странице конечной точки в режиме реального времени перейдите на вкладку **"Использование** ".
1. Просмотрите пример кода, чтобы использовать модель.

## Если разрешено время

Если вы хотите дополнительно поэкспериментировать с автоматизированным машинным обучением, попробуйте обучить **модель классификации** на **основе файла penguins.csv, который был включен в **архив ml-data.zip****, скачанный ранее. Используйте все столбцы в этом наборе данных.

После обучения и развертывания модели классификации его можно протестировать в конечной точке с помощью следующего JSON:

```json
{
    "input_data": {
    "columns": [
        "CulmenLength",
        "CulmenDepth",
        "FlipperLength",
        "BodyMass"
    ],
    "index": [0],
    "data": [[45.2,13.8,215,4750]]
    }
}
```

## Очистка

Если вы использовали Машинное обучение Azure для выполнения этого упражнения, следует удалить созданные ресурсы, чтобы избежать ненужных операций использования Azure.

1. На [вкладке **"Конечные точки" на вкладке Студия машинного обучения Azure "](https://ml.azure.com)Конечные точки"** выберите развернутую конечную точку. Затем щелкните **Удалить** и подтвердите удаление конечной точки.

    Удаление вычислений гарантирует, что в вашей подписке не будет начисляться плата за вычислительные ресурсы. Однако с вас будет взиматься небольшая плата за хранение данных, так как в вашей подписке существует рабочая область Машинного обучения Azure. Если вы завершили изучение возможностей Машинного обучения Azure, можно удалить рабочую область Машинного обучения Azure и связанные с ней ресурсы.

Чтобы удалить рабочую область:

1. На [портале Microsoft Azure](https://portal.azure.com) (страница **Группы ресурсов**) откройте группу ресурсов, указанную при создании рабочей области машинного обучения Azure.
2. Щелкните **Удалить группу ресурсов**, введите имя группы ресурсов, чтобы подтвердить ее удаление, и выберите **Удалить**.
